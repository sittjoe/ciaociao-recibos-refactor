<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Acceso | ciaociao.mx</title>
    <style>
      :root{
        --bg:#f8f7f3; --paper:#fffdfa; --ink:#1f2937; --muted:#6b7280;
        --gold-1:#bfa36f; --gold-2:#d9c08c; --gold-3:#a98e5b; --line:#e7e3d9;
      }
      body{ margin:0; background:var(--bg); color:var(--ink); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif; }
      .wrap{ min-height:100dvh; display:grid; place-items:center; padding:24px; }
      .card{ width:100%; max-width:380px; background:linear-gradient(#fffefa,#fffdf7); border:1px solid var(--line); border-radius:16px; padding:22px; box-shadow:0 18px 50px rgba(0,0,0,.08), 0 4px 16px rgba(0,0,0,.05); }
      .title{ display:flex; align-items:center; gap:14px; margin:0 0 8px; }
      .title img{ width: 72px; height:auto; border-radius:12px; }
      h1{ margin:0; font-size:20px; font-family:"Playfair Display",serif; letter-spacing:.04em; }
      p{ margin:6px 0 14px; color:var(--muted); font-size:13px; }
      .input{ width:100%; padding:12px; background:#fff; border:1px solid var(--line); border-radius:12px; color:var(--ink); }
      .actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:14px; }
      .btn{ padding:10px 12px; border-radius:12px; border:1px solid var(--gold-3); background:linear-gradient(180deg,var(--gold-2),var(--gold-1)); color:#664f22; cursor:pointer; font-weight:600; }
      .btn.secondary{ background:#f7f5ee; border-color:#e6dcc6; color:#5b4a26; }
      .error{ color:#dc2626; font-size:12px; min-height:16px; margin-top:8px; }
    </style>
  </head>
  <body>
    <!-- security module optional; login handles session inline for reliability -->
    <div class="wrap">
      <div class="card">
        <div class="title">
          <img src="../assets/logo.png" alt="ciaociao.mx" />
          <div>
            <h1>Acceso</h1>
            <p>Ingresa la contrase침a para continuar.</p>
          </div>
        </div>
        <input id="passInput" class="input" type="password" placeholder="Contrase침a" autocomplete="current-password" />
        <div id="err" class="error"></div>
        <div class="actions">
          <button id="cancel" class="btn">Cancelar</button>
          <button id="enter" class="btn primary">Entrar</button>
        </div>
      </div>
    </div>
    <script>
      const q = new URLSearchParams(location.search);
      const redirect = q.get('redirect');
      const input = document.getElementById('passInput');
      const err = document.getElementById('err');
      const enter = document.getElementById('enter');
      const cancel = document.getElementById('cancel');
      const base = (function(){ try{ const parts = location.pathname.split('/').filter(Boolean); if (location.host.includes('github.io') && parts.length) return '/' + parts[0]; return ''; } catch { return ''; } })();

      function goHome(){ window.location.replace(redirect ? redirect : base + '/index.html'); }
      function setSessionLocal(hours){
        const expiry = Date.now() + (hours||12) * 60 * 60 * 1000;
        try {
          localStorage.setItem('isAuthenticated', 'true');
          localStorage.setItem('sessionExpiry', String(expiry));
        } catch {}
      }
      function tryLogin(){
        if (input.value === '27181730') { setSessionLocal(12); goHome(); }
        else { err.textContent = 'Contrase침a incorrecta'; input.select(); }
      }
      enter.addEventListener('click', tryLogin);
      input.addEventListener('keydown', e => { if (e.key === 'Enter') tryLogin(); });
      cancel.addEventListener('click', () => { window.location.href = 'https://www.ciaociao.mx'; });
      setTimeout(()=> input.focus(), 50);
      // Si ya est치 autenticado, redirigir de inmediato
      try { if (localStorage.getItem('isAuthenticated')==='true' && parseInt(localStorage.getItem('sessionExpiry')||'0',10) > Date.now()) goHome(); } catch{}
    </script>
  </body>
  </html>
